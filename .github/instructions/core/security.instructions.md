# Security Instructions

エージェントがコードを生成・操作する際のセキュリティガイドラインです。

---

## 1. 機密情報の取り扱い

### 禁止事項

- **ハードコード禁止**: API キー、パスワード、トークン、接続文字列をソースコードに直接書かないでください。
- **コミット禁止**: `.env` ファイルや秘密情報を含むファイルを Git にコミットしないでください。

### 推奨事項

- **環境変数の使用**: 機密情報は環境変数（`process.env`, `os.environ` 等）から取得してください。
- **シークレット管理**: Azure Key Vault、GitHub Secrets、AWS Secrets Manager などの専用サービスを活用してください。
- **`.gitignore` の設定**: `.env`, `*.pem`, `*.key` などを必ず除外してください。

```bash
# .gitignore の例
.env
.env.local
*.pem
*.key
secrets/
```

---

## 2. 外部ライブラリの利用

### 確認事項

- **ライセンス確認**: 使用するライブラリのライセンス（MIT, Apache, GPL 等）がプロジェクトの方針と適合するか確認してください。
- **脆弱性チェック**: 既知の脆弱性がないか確認してください。

### 推奨ツール

| 言語    | ツール                             |
| ------- | ---------------------------------- |
| Node.js | `npm audit`, `snyk`                |
| Python  | `pip-audit`, `safety`              |
| .NET    | `dotnet list package --vulnerable` |

---

## 3. 外部 API 呼び出しの制限

- **最小権限の原則**: API には必要最小限のスコープ・権限のみを付与してください。
- **レート制限の考慮**: API 呼び出し回数に上限があるサービスでは、リトライやバックオフを実装してください。
- **エラーメッセージの秘匿**: スタックトレースや内部情報をユーザー向けエラーメッセージに含めないでください。

---

## 4. Git 操作の制限

- **`git push` の禁止**: ユーザーからの明示的な指示がない限り、リモートへのプッシュは行わないでください。
- **`--force` の禁止**: 強制プッシュは原則禁止です。履歴の改変が必要な場合は人間に確認を求めてください。
- **ブランチ保護**: `main` / `master` への直接コミットは避け、PR ベースのワークフローを推奨します。

---

## 5. 入力検証

- **サニタイズ**: ユーザー入力やファイル内容を処理する際は、インジェクション攻撃（SQL, コマンド, XSS 等）を防ぐためにサニタイズしてください。
- **パス検証**: ファイルパスを扱う際は、ディレクトリトラバーサル（`../`）を防止してください。
